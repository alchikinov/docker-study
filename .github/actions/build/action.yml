name: 'Build and push docker image'
description: 'Simple composite action for building and pushing docker images'
inputs:
  dockerhub_user: 
    description: 'Docker hub username'
    required: true
  dockerhub_token: 
    description: 'Docker hub token'
    required: true
  application:
    description: 'Application for which docker image should be built'
    required: true
  docker_image_tag: 
    description: 'Tag how image should be tagged'
    required: true
runs:
  using: "composite"
  steps:
    - name: Build docker image
      uses: docker/login-action@v3
      with:
            username: ${{ inputs.dockerhub_user }}
            password: ${{ inputs.dockerhub_token }}
    - name: Build docker image
      run: docker build -t ${{ inputs.docker_image_tag}} ./webapp/${{ inputs.application }}
      shell: bash  
    - name: Push docker image
      run: docker push ${{ inputs.docker_image_tag}}
      shell: bash